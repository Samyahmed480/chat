<!DOCTYPE html>
<html lang="ar" dir="rtl" class="transition-colors duration-300">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat App - Modern Dark Mode</title>
    
    <!-- Ø¥Ø¹Ø¯Ø§Ø¯ Tailwind Ù…Ø¹ Ø¯Ø¹Ù… Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class', // ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ Ø¹Ø¨Ø± Ø§Ù„ÙƒÙ„Ø§Ø³
            theme: {
                extend: {
                    colors: {
                        primary: '#6366f1', // Indigo 500
                        primaryDark: '#4338ca', // Indigo 700
                        darkBg: '#0f172a', // Slate 900
                        darkCard: '#1e293b', // Slate 800
                        darkHover: '#334155', // Slate 700
                    },
                    fontFamily: {
                        cairo: ['Cairo', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- Ø®Ø· Cairo -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        body {
            font-family: 'Cairo', sans-serif;
        }
        
        /* ØªØ­Ø³ÙŠÙ† Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± */
        ::-webkit-scrollbar {
            width: 5px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 10px;
        }
        .dark ::-webkit-scrollbar-thumb {
            background: #475569; 
        }

        /* Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø¨Ù†Ù…Ø· Ø¹ØµØ±ÙŠ */
        .chat-pattern {
            background-color: #f8fafc;
            background-image: radial-gradient(#e2e8f0 1px, transparent 1px);
            background-size: 20px 20px;
        }
        .dark .chat-pattern {
            background-color: #0f172a;
            background-image: radial-gradient(#334155 1px, transparent 1px);
        }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ø²Ø¬Ø§Ø¬ */
        .glass-header {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
        }
        .dark .glass-header {
            background: rgba(30, 41, 59, 0.9);
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-100 h-screen flex items-center justify-center transition-colors duration-300">

    <!-- Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Ø´ÙƒÙ„ Ø¹Ø§Ø¦Ù… Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©) -->
    <div class="w-full h-full md:h-[95vh] md:w-[95vw] lg:w-[1200px] bg-white dark:bg-darkCard md:rounded-2xl shadow-2xl flex overflow-hidden relative transition-colors duration-300 border dark:border-gray-700">
        
        <!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© -->
        <aside class="w-full md:w-[350px] lg:w-[400px] flex flex-col border-l border-gray-200 dark:border-gray-700 bg-white dark:bg-darkCard transition-colors duration-300" id="sidebar">
            
            <!-- Ø±Ø£Ø³ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© -->
            <header class="p-5 flex justify-between items-center">
                <h1 class="text-2xl font-bold text-primary dark:text-indigo-400">Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª</h1>
                <div class="flex gap-3">
                    <!-- Ø²Ø± Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ -->
                    <button onclick="toggleDarkMode()" class="w-10 h-10 rounded-full bg-gray-100 dark:bg-darkHover flex items-center justify-center text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-all shadow-sm">
                        <i class="fas fa-moon dark:hidden"></i>
                        <i class="fas fa-sun hidden dark:block text-yellow-400"></i>
                    </button>
                    <!-- Ø²Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© -->
                    <button class="w-10 h-10 rounded-full bg-gray-100 dark:bg-darkHover flex items-center justify-center text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-all shadow-sm">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </header>

            <!-- Ø§Ù„Ø¨Ø­Ø« -->
            <div class="px-5 pb-2">
                <div class="relative">
                    <i class="fas fa-search absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                    <input type="text" placeholder="Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„..." class="w-full bg-gray-100 dark:bg-darkBg text-sm rounded-xl py-3 pr-10 pl-4 outline-none focus:ring-2 focus:ring-primary dark:text-white transition-all">
                </div>
            </div>

            <!-- ØªØ¨ÙˆÙŠØ¨Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ) -->
            <div class="flex px-5 mt-2 gap-4 text-sm font-medium text-gray-500 dark:text-gray-400 border-b border-gray-100 dark:border-gray-700 pb-1">
                <span class="text-primary dark:text-indigo-400 border-b-2 border-primary dark:border-indigo-400 pb-2 cursor-pointer">Ø§Ù„ÙƒÙ„</span>
                <span class="hover:text-gray-800 dark:hover:text-gray-200 cursor-pointer pb-2">ØºÙŠØ± Ù…Ù‚Ø±ÙˆØ¡Ø©</span>
                <span class="hover:text-gray-800 dark:hover:text-gray-200 cursor-pointer pb-2">Ù…Ø¬Ù…ÙˆØ¹Ø§Øª</span>
            </div>

            <!-- Ù‚Ø§Ø¦Ù…Ø© Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ -->
            <ul class="flex-1 overflow-y-auto py-2 space-y-1" id="contacts-list">
                <!-- ÙŠØªÙ… Ø§Ù„ØªØ¹Ø¨Ø¦Ø© Ø¨ÙˆØ§Ø³Ø·Ø© JS -->
            </ul>
        </aside>

        <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© -->
        <main class="hidden md:flex flex-1 flex-col relative bg-white dark:bg-darkBg transition-colors duration-300" id="chat-area">
            
            <!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ -->
            <div id="welcome-screen" class="hidden h-full flex flex-col items-center justify-center chat-pattern text-center p-10 transition-colors duration-300">
                <div class="w-40 h-40 bg-indigo-100 dark:bg-indigo-900/30 rounded-full flex items-center justify-center mb-6 animate-pulse">
                    <i class="fas fa-comments text-6xl text-primary dark:text-indigo-400"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-100 mb-2">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©</h2>
                <p class="text-gray-500 dark:text-gray-400 max-w-md">Ø§Ø®ØªØ± Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø±Ø§Ø³Ù„Ø©. ÙŠØ¯Ø¹Ù… Ù‡Ø°Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ ÙˆØ§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…ØªØ¬Ø§ÙˆØ¨.</p>
            </div>

            <!-- Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù†Ø´Ø·Ø© -->
            <div id="active-chat-container" class="flex flex-col h-full w-full relative">
                
                <!-- Ø±Ø£Ø³ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© -->
                <header class="glass-header h-20 px-6 flex justify-between items-center border-b border-gray-100 dark:border-gray-700 z-20 absolute top-0 w-full transition-colors duration-300">
                    <div class="flex items-center gap-4">
                        <button onclick="backToMenu()" class="md:hidden text-gray-600 dark:text-gray-300 hover:text-primary transition-colors">
                            <i class="fas fa-arrow-right text-xl"></i>
                        </button>
                        <div class="relative">
                            <img id="header-img" src="" class="w-12 h-12 rounded-full object-cover border-2 border-white dark:border-gray-600 shadow-sm">
                            <span class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 border-2 border-white dark:border-gray-800 rounded-full"></span>
                        </div>
                        <div>
                            <h3 id="header-name" class="font-bold text-gray-800 dark:text-white text-lg leading-tight"></h3>
                            <span class="text-xs text-primary dark:text-indigo-400 font-medium">Ù†Ø´Ø· Ø§Ù„Ø¢Ù†</span>
                        </div>
                    </div>
                    
                    <div class="flex gap-4 text-gray-400 dark:text-gray-400">
                        <button class="w-10 h-10 rounded-full hover:bg-gray-100 dark:hover:bg-darkHover flex items-center justify-center transition-all">
                            <i class="fas fa-phone"></i>
                        </button>
                        <button class="w-10 h-10 rounded-full hover:bg-gray-100 dark:hover:bg-darkHover flex items-center justify-center transition-all">
                            <i class="fas fa-video"></i>
                        </button>
                        <button class="w-10 h-10 rounded-full hover:bg-gray-100 dark:hover:bg-darkHover flex items-center justify-center transition-all">
                            <i class="fas fa-info-circle"></i>
                        </button>
                    </div>
                </header>

                <!-- ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ -->
                <div id="messages-box" class="flex-1 chat-pattern overflow-y-auto p-5 pt-24 pb-4 space-y-4">
                    <!-- Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ -->
                </div>

                <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ÙƒØªØ§Ø¨Ø© -->
                <footer class="glass-header p-4 border-t border-gray-100 dark:border-gray-700 transition-colors duration-300">
                    <div class="flex items-center gap-3 bg-gray-100 dark:bg-darkCard p-2 rounded-2xl border border-transparent focus-within:border-primary dark:focus-within:border-indigo-500 transition-all shadow-inner">
                        <button class="w-10 h-10 text-gray-400 hover:text-primary dark:hover:text-indigo-400 transition-colors">
                            <i class="far fa-smile text-xl"></i>
                        </button>
                        <button class="w-10 h-10 text-gray-400 hover:text-primary dark:hover:text-indigo-400 transition-colors">
                            <i class="fas fa-paperclip text-xl"></i>
                        </button>
                        
                        <input type="text" id="message-input" class="flex-1 bg-transparent outline-none text-gray-700 dark:text-gray-200 px-2" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§...">
                        
                        <button onclick="sendMessage()" class="w-12 h-12 bg-primary hover:bg-primaryDark text-white rounded-xl shadow-lg hover:shadow-indigo-500/30 transform hover:scale-105 transition-all flex items-center justify-center">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </footer>
            </div>
        </main>
    </div>

    <script>
        // --- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ ---
        function toggleDarkMode() {
            document.documentElement.classList.toggle('dark');
            // Ø­ÙØ¸ Ø§Ù„ØªÙØ¶ÙŠÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠØŒ Ù‡Ù†Ø§ Ù„Ù„Ù…Ø­Ø§ÙƒØ§Ø© ÙÙ‚Ø·)
            const isDark = document.documentElement.classList.contains('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        }

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø­ÙÙˆØ¸ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        if (localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }

        // --- Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ---
        const contacts = [
            {
                id: 1,
                name: "Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯",
                avatar: "https://ui-avatars.com/api/?name=Ahmad+M&background=6366f1&color=fff",
                lastMessage: "Ø§Ù„Ù…Ù„Ù Ø¬Ø§Ù‡Ø² Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ğŸ“",
                time: "10:30 Øµ",
                unread: 2,
                online: true,
                messages: [
                    { text: "Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ…ØŒ ÙƒÙŠÙ Ø§Ù„Ø¹Ù…Ù„ØŸ", time: "10:00 Øµ", type: "in" },
                    { text: "ÙˆØ¹Ù„ÙŠÙƒÙ… Ø§Ù„Ø³Ù„Ø§Ù…ØŒ ÙƒÙ„ Ø´ÙŠØ¡ Ù…Ù…ØªØ§Ø²", time: "10:05 Øµ", type: "out" },
                    { text: "Ø§Ù„Ù…Ù„Ù Ø¬Ø§Ù‡Ø² Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ğŸ“", time: "10:30 Øµ", type: "in" }
                ]
            },
            {
                id: 2,
                name: "Ù…Ù†Ù‰ Ø³Ø¹ÙŠØ¯",
                avatar: "https://ui-avatars.com/api/?name=Mona+S&background=ec4899&color=fff",
                lastMessage: "Ø´ÙƒØ±Ø§Ù‹ Ù„ÙƒØŒ Ø³Ø£Ø±Ø§Ùƒ ØºØ¯Ø§Ù‹",
                time: "Ø£Ù…Ø³",
                unread: 0,
                online: false,
                messages: [
                    { text: "Ù‡Ù„ Ø§Ù„Ù…ÙˆØ¹Ø¯ Ù„Ø§ ÙŠØ²Ø§Ù„ Ù‚Ø§Ø¦Ù…Ø§Ù‹ØŸ", time: "9:00 Ù…", type: "out" },
                    { text: "Ù†Ø¹Ù…ØŒ Ø¨Ø§Ù„ØªØ£ÙƒÙŠØ¯", time: "9:10 Ù…", type: "in" },
                    { text: "Ø´ÙƒØ±Ø§Ù‹ Ù„ÙƒØŒ Ø³Ø£Ø±Ø§Ùƒ ØºØ¯Ø§Ù‹", time: "9:15 Ù…", type: "in" }
                ]
            },
            {
                id: 3,
                name: "ÙØ±ÙŠÙ‚ Ø§Ù„ØªØµÙ…ÙŠÙ…",
                avatar: "https://ui-avatars.com/api/?name=Design+Team&background=10b981&color=fff",
                lastMessage: "ØªÙ… ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…",
                time: "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡",
                unread: 5,
                online: true,
                messages: [
                    { text: "ÙŠØ§ Ø´Ø¨Ø§Ø¨ØŒ Ù…Ø§ Ù‡ÙŠ Ø¢Ø®Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§ØªØŸ", time: "1:00 Ù…", type: "out" },
                    { text: "ØªÙ… ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…", time: "1:15 Ù…", type: "in" }
                ]
            }
        ];

        let activeChatId = null;

        document.addEventListener('DOMContentLoaded', () => {
            renderContacts();
            
            document.getElementById('message-input').addEventListener('keypress', function (e) {
                if (e.key === 'Enter') sendMessage();
            });

            if(window.innerWidth > 768) {
               openChat(contacts[0].id);
            } else {
                document.getElementById('chat-area').classList.add('hidden');
                document.getElementById('sidebar').classList.remove('hidden');
            }
        });

        function renderContacts() {
            const list = document.getElementById('contacts-list');
            list.innerHTML = '';

            contacts.forEach(contact => {
                const isActive = activeChatId === contact.id;
                const activeClass = isActive 
                    ? 'bg-indigo-50 dark:bg-indigo-900/20 border-r-4 border-primary dark:border-indigo-500' 
                    : 'border-r-4 border-transparent hover:bg-gray-50 dark:hover:bg-darkHover';

                const li = document.createElement('li');
                li.className = `flex items-center gap-4 p-4 cursor-pointer transition-all duration-200 ${activeClass}`;
                li.onclick = () => openChat(contact.id);

                li.innerHTML = `
                    <div class="relative">
                        <img src="${contact.avatar}" class="w-12 h-12 rounded-full object-cover shadow-sm">
                        ${contact.online ? '<span class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 border-2 border-white dark:border-darkCard rounded-full"></span>' : ''}
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="flex justify-between items-center mb-1">
                            <h3 class="font-bold text-gray-800 dark:text-gray-200 truncate ${isActive ? 'text-primary dark:text-indigo-400' : ''}">${contact.name}</h3>
                            <span class="text-xs text-gray-400 font-medium">${contact.time}</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <p class="text-sm text-gray-500 dark:text-gray-400 truncate w-[80%]">${contact.lastMessage}</p>
                            ${contact.unread > 0 ? `<span class="bg-primary text-white text-[10px] font-bold h-5 min-w-[20px] px-1.5 flex items-center justify-center rounded-full shadow-lg shadow-indigo-500/30">${contact.unread}</span>` : ''}
                        </div>
                    </div>
                `;
                list.appendChild(li);
            });
        }

        function openChat(id) {
            activeChatId = id;
            const contact = contacts.find(c => c.id === id);
            
            if (window.innerWidth < 768) {
                document.getElementById('sidebar').classList.add('hidden');
                document.getElementById('chat-area').classList.remove('hidden');
                document.getElementById('chat-area').classList.add('flex');
            }

            document.getElementById('header-img').src = contact.avatar;
            document.getElementById('header-name').innerText = contact.name;
            renderContacts();
            renderMessages(contact.messages);
        }

        function renderMessages(messages) {
            const box = document.getElementById('messages-box');
            box.innerHTML = '';
            
            box.innerHTML += `
                <div class="flex justify-center mb-6">
                    <span class="bg-gray-200 dark:bg-darkCard text-gray-500 dark:text-gray-400 text-xs font-bold px-4 py-1.5 rounded-full shadow-sm">Ø§Ù„ÙŠÙˆÙ…</span>
                </div>
            `;

            messages.forEach(msg => {
                const isOut = msg.type === 'out';
                const div = document.createElement('div');
                div.className = `flex mb-4 ${isOut ? 'justify-end' : 'justify-start'}`; // RTL: justify-end = Ø§Ù„ÙŠØ³Ø§Ø±
                
                // ØªØµÙ…ÙŠÙ… Ø§Ù„ÙÙ‚Ø§Ø¹Ø© Ù…Ø®ØªÙ„Ù Ø¹Ù† ÙˆØ§ØªØ³Ø§Ø¨
                // Ø£Ù†Ø§ (Ø§Ù„Ù…Ø±Ø³Ù„): ØªØ¯Ø±Ø¬ Ù„ÙˆÙ†ÙŠ Ø£Ø²Ø±Ù‚/Ø¨Ù†ÙØ³Ø¬ÙŠØŒ Ù†Øµ Ø£Ø¨ÙŠØ¶
                // Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„: Ø±Ù…Ø§Ø¯ÙŠ ÙØ§ØªØ­ (Ø£Ùˆ ØºØ§Ù…Ù‚ ÙÙŠ Ø§Ù„Ù„ÙŠÙ„ÙŠ)
                const bubbleClass = isOut 
                    ? 'bg-gradient-to-br from-primary to-purple-600 text-white rounded-2xl rounded-tr-none shadow-lg shadow-indigo-500/20' 
                    : 'bg-white dark:bg-darkHover text-gray-800 dark:text-gray-200 rounded-2xl rounded-tl-none shadow-sm border border-gray-100 dark:border-gray-700';

                div.innerHTML = `
                    <div class="${bubbleClass} p-3 px-5 max-w-[75%] min-w-[100px] relative group transition-all duration-300">
                        <p class="text-sm font-medium leading-relaxed">${msg.text}</p>
                        <div class="flex justify-end items-center gap-1 mt-1 opacity-70">
                            <span class="text-[10px] font-light">${msg.time}</span>
                            ${isOut ? '<i class="fas fa-check text-[10px]"></i>' : ''}
                        </div>
                    </div>
                `;
                
                // ØªØµØ­ÙŠØ­ Ø§Ù„Ø§ØªØ¬Ø§Ù‡ ÙÙŠ RTL
                 if (isOut) {
                    div.style.justifyContent = 'flex-end'; // Ø£Ù†Ø§ ÙŠØ³Ø§Ø±
                    div.classList.remove('justify-end');
                    div.classList.add('justify-end'); 
                } else {
                    div.style.justifyContent = 'flex-start'; // Ù‡Ùˆ ÙŠÙ…ÙŠÙ†
                    div.classList.remove('justify-start');
                    div.classList.add('justify-start');
                }

                box.appendChild(div);
            });

            box.scrollTop = box.scrollHeight;
        }

        function sendMessage() {
            const input = document.getElementById('message-input');
            const text = input.value.trim();
            
            if (text && activeChatId) {
                const contact = contacts.find(c => c.id === activeChatId);
                const now = new Date();
                const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

                contact.messages.push({
                    text: text,
                    time: timeString,
                    type: 'out'
                });

                contact.lastMessage = text;
                contact.time = timeString;

                renderMessages(contact.messages);
                renderContacts();
                input.value = '';
                input.focus();
            }
        }

        function backToMenu() {
            document.getElementById('chat-area').classList.add('hidden');
            document.getElementById('chat-area').classList.remove('flex');
            document.getElementById('sidebar').classList.remove('hidden');
            activeChatId = null;
            renderContacts();
        }
    </script>
</body>
</html>
